// Similar to previous version, simplified for brevity
